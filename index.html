<!DOCTYPE html>
<html lang="en">

<head>
  <base href="https://cdn.jsdelivr.net/gh/gn-math/gn-math.github.io@main/">
  <link rel="icon" type="image/png" href="https://codehs.com/uploads/84799a0bb8e09668879b73acd5e7abaa">
  <link rel="icon" type="image/png" sizes="32x32" href="https://codehs.com/uploads/84799a0bb8e09668879b73acd5e7abaa">
  <link rel="apple-touch-icon" href="https://codehs.com/uploads/84799a0bb8e09668879b73acd5e7abaa">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700;800;900&display=swap" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Story Network GN Math</title>
  <meta name="title" content="GN-Math">
  <meta name="description" content="Play unbl*cked games like Crazy Cattle 3D and DriveMad on GN-Math. Fast, free, no downloads—perfect for school or home.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://gn-math.github.io/">
  <meta property="og:title" content="GN-Math">
  <meta property="og:description" content="Play unbl*cked games like Crazy Cattle 3D and DriveMad on GN-Math. Fast, free, no downloads—perfect for school or home.">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://gn-math.github.io/">
  <meta name="twitter:title" content="GN-Math">
  <meta name="twitter:description" content="Play unbl*cked games like Crazy Cattle 3D and DriveMad on GN-Math. Fast, free, no downloads—perfect for school or home.">
  <meta name="keywords" content="unblocked games, games for school, browser games, chromebook games, no download games, html5 games, free unblocked games, gn-math, fun games at school, crazy cattle 3d, play crazy cattle 3d, crazy cattle 3d unblocked, crazy cattle, crazy cattle unblocked, play crazy cattle, crazy cattle online, crazy cattle 3d online">

  <style>
    :root {
      --primary-color: #0000ff;
      --text-color: #e0e0e0;
      --background-color: #0a0a15;
      --card-bg: #111122;
      --shadow: 0 8px 24px rgba(0,0,0,0.4);
      --popup-bg: #1a1a2e;
      --font-family: 'Montserrat', system-ui, -apple-system, sans-serif;
      --input-bg: rgba(0,0,255,0.08);
      --input-border: rgba(0,0,255,0.3);
      --input-border-focus: #0000ff;
    }

    *,
    *::before,
    *::after {
      font-family: var(--font-family) !important;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-family);
      font-weight: 500;
      margin: 0;
      padding: 0;
      background-color: var(--background-color);
      color: var(--text-color);
    }

    h1, h2, h3, h4, h5, h6,
    summary,
    button,
    .zone-item button,
    #popupTitle,
    #zoneName,
    .logo,
    .control-buttons button,
    .zone-controls button {
      font-weight: 800 !important;
    }

    input {
      font-weight: 600;
    }

    header {
      background: linear-gradient(to bottom, #000033, #000055);
      padding: 1.2rem 1rem;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: var(--shadow);
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1.6rem;
      font-weight: 900;
    }

    .logo-img {
      height: 48px;
      border-radius: 12px;
    }

    .search-container {
      flex: 1;
      min-width: 220px;
    }

    #searchBar {
      width: 100%;
      padding: 0.75rem 1.3rem;
      border: 1px solid var(--input-border);
      border-radius: 9999px;
      background: var(--input-bg);
      color: white;
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    #searchBar:focus {
      outline: none;
      border-color: var(--input-border-focus);
      box-shadow: 0 0 0 3px rgba(0,0,255,0.18);
    }

    .control-buttons button {
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 9999px;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .control-buttons button:hover {
      opacity: 0.92;
      transform: translateY(-1px);
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1.5rem;
    }

    .zone-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 28px;
      margin-top: 1.2rem;
    }

    .zone-item {
      background: var(--card-bg);
      border-radius: 16px;
      overflow: hidden;
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: all 0.28s ease;
      display: flex;
      flex-direction: column;
    }

    .zone-item:hover {
      transform: translateY(-10px) scale(1.035);
      box-shadow: 0 20px 50px rgba(0,0,255,0.22);
    }

    .zone-item img {
      width: 100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
    }

    .zone-item button {
      background: rgba(0,0,255,0.10);
      color: var(--text-color);
      border: none;
      padding: 14px;
      font-size: 1.05rem;
      cursor: pointer;
      text-align: center;
      flex-grow: 1;
      transition: background 0.2s;
    }

    .zone-item button:hover {
      background: rgba(0,0,255,0.18);
    }

    #zoneViewer {
      position: fixed;
      inset: 0;
      background: rgba(10,10,21,0.96);
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: none;
      flex-direction: column;
    }

    .zone-header {
      background: linear-gradient(to bottom, #000033, #000055);
      color: white;
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 16px rgba(0,0,0,0.5);
    }

    #zoneName {
      font-size: 1.45rem;
      margin: 0;
    }

    #zoneAuthor {
      font-size: 0.95rem;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
    }

    .zone-controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .zone-controls button {
      background: rgba(0,0,255,0.12);
      border: 1px solid rgba(0,0,255,0.35);
      color: white;
      padding: 0.65rem 1.3rem;
      border-radius: 9999px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.2s ease;
      backdrop-filter: blur(4px);
    }

    .zone-controls button:hover {
      background: rgba(0,0,255,0.22);
      border-color: rgba(0,0,255,0.7);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,255,0.25);
    }

    #zoneFrame {
      flex-grow: 1;
      border: none;
      width: 94%;
      height: 92%;
      margin: 20px auto;
      border-radius: 16px;
      box-shadow: var(--shadow);
      background: #000;
    }

    #popupOverlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.65);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      backdrop-filter: blur(6px);
    }

    .popup {
      background: var(--popup-bg);
      border-radius: 16px;
      box-shadow: 0 12px 48px rgba(0,0,0,0.6);
      width: 90%;
      max-width: 480px;
      overflow: hidden;
    }

    .popup-header {
      background: var(--primary-color);
      color: white;
      padding: 1.2rem 1.6rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    #popupTitle {
      margin: 0;
      font-size: 1.4rem;
    }

    #popupClose {
      background: none;
      border: none;
      color: white;
      font-size: 2.2rem;
      cursor: pointer;
      line-height: 1;
    }

    #popupBody {
      padding: 1.8rem;
      font-size: 1.05rem;
      line-height: 1.5;
    }

    #popupBody button {
      width: 100%;
      padding: 1rem;
      margin: 0.8rem 0;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 9999px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    #popupBody button:hover {
      opacity: 0.93;
      transform: translateY(-1px);
    }

    #popupBody input {
      width: 100%;
      padding: 0.8rem 1.2rem;
      margin: 0.6rem 0 1.2rem;
      border: 1px solid var(--input-border);
      border-radius: 9999px;
      background: var(--input-bg);
      color: white;
      font-size: 1rem;
    }

    #popupBody input:focus {
      outline: none;
      border-color: var(--input-border-focus);
      box-shadow: 0 0 0 3px rgba(0,0,255,0.18);
    }

    summary {
      font-size: 1.4rem;
      font-weight: 800;
      cursor: pointer;
      padding: 0.8rem;
      background: rgba(0,0,255,0.1);
      border-radius: 12px;
      margin-bottom: 1rem;
    }

    footer {
      background: var(--card-bg);
      padding: 1.5rem;
      text-align: center;
      margin-top: 3rem;
      border-radius: 16px 16px 0 0;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 24px;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }

    .footer-links a {
      color: #0000ff;
      text-decoration: none;
      font-weight: 600;
    }

    @media (max-width: 768px) {
      .header-content { flex-direction: column; gap: 1rem; }
      .search-container { width: 100%; }
      .zone-container { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
      .zone-controls { flex-direction: column; gap: 12px; }
      .zone-controls button { width: 100%; }
    }
  </style>
</head>

<body class="dark-mode">

  <header>
    <div class="header-content">
      <div class="logo">
        <img src="https://codehs.com/uploads/84799a0bb8e09668879b73acd5e7abaa" alt="Logo" class="logo-img">
        Story Network GN Math
      </div>
      <div class="search-container">
        <input type="text" id="searchBar" placeholder="Search Games..." oninput="filterZones()">
      </div>
      <div class="control-buttons">
        <button id="settings">Settings</button>
      </div>
    </div>
  </header>

  <main>

    <details id="recentZonesWrapper" open>
      <summary>Recently Played</summary>
      <div id="recentZonesList" class="zone-container">
        <p style="text-align:center; padding:2rem;">No recently played zones yet.</p>
      </div>
      <button onclick="localStorage.removeItem('recentZones'); updateRecentlyPlayed();" style="margin:1.5rem auto; display:block; background:#0000ff; color:white; border:none; padding:0.7rem 1.4rem; border-radius:999px; cursor:pointer;">
        Clear Recent
      </button>
    </details>

    <hr style="margin:2rem 0; border-color:rgba(255,255,255,0.08);">

    <details id="allZonesWrapper" open>
      <summary>All Games</summary>
      <div id="container" class="zone-container">Loading...</div>
    </details>

  </main>

  <div id="zoneViewer">
    <div id="zoneLoading">
      <div class="spinner"></div>
    </div>
    <div class="zone-header">
      <div class="zone-title">
        <h2 id="zoneName">zone</h2>
        <span id="zoneId" style="display: none;"></span>
        <a id="zoneAuthor" href="#" target="_blank">by Author</a>
      </div>
      <div class="zone-controls">
        <button onclick="fullscreenZone()">Fullscreen</button>
        <button onclick="aboutBlank()">Open in New Tab</button>
        <button onclick="downloadZone()">Download</button>
        <button onclick="closeZone()">Close</button>
      </div>
    </div>
    <iframe id="zoneFrame"></iframe>
  </div>

  <div id="popupOverlay">
    <div class="popup">
      <div class="popup-header">
        <h3 id="popupTitle">Title</h3>
        <button id="popupClose" onclick="closePopup()">×</button>
      </div>
      <div id="popupBody">
        Content will be here
      </div>
    </div>
  </div>

  <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-client="ca-pub-5521219086088837"
    data-ad-slot="5549138288" data-ad-format="auto" data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <footer>
    <div class="footer-links">
      <a href="#" onclick="showContact(); return false;">Contact</a>
      <a href="#" onclick="loadPrivacy(); return false;">Privacy Policy</a>
      <a href="javascript:saveData()">Export Data</a>
      <label for="importData" style="color: #0000ff; cursor: pointer;">Import Data</label>
      <input type="file" id="importData" style="display: none;" onchange="loadData(event)">
    </div>
  </footer>

  <script>
    const container = document.getElementById('container');
    const zoneViewer = document.getElementById('zoneViewer');
    let zoneFrame = document.getElementById('zoneFrame');
    const searchBar = document.getElementById('searchBar');
    const zonesURL = "https://cdn.jsdelivr.net/gh/gn-math/assets@main/zones.json";
    const coverURL = "https://cdn.jsdelivr.net/gh/gn-math/covers@main";
    const htmlURL = "https://cdn.jsdelivr.net/gh/gn-math/html@main";
    let zones = [];
    let popularityData = {};

    function recordRecent(id) {
      let recents = JSON.parse(localStorage.getItem("recentZones") || "[]");
      recents = [id, ...recents.filter(x => x !== id)].slice(0, 12);
      localStorage.setItem("recentZones", JSON.stringify(recents));
      updateRecentlyPlayed();
    }

    function updateRecentlyPlayed() {
      const recents = JSON.parse(localStorage.getItem("recentZones") || "[]");
      const list = document.getElementById("recentZonesList");
      if (!list) return;
      list.innerHTML = "";

      if (recents.length === 0) {
        list.innerHTML = '<p style="text-align:center; padding:2rem;">No recently played zones yet.</p>';
        return;
      }

      recents.forEach(id => {
        const zone = zones.find(z => z.id == id);
        if (!zone) return;

        const item = document.createElement("div");
        item.className = "zone-item";
        item.onclick = () => openZone(zone);

        const img = document.createElement("img");
        img.dataset.src = zone.cover.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
        img.alt = zone.name;
        img.loading = "lazy";
        img.className = "lazy-zone-img";
        item.appendChild(img);

        const btn = document.createElement("button");
        btn.textContent = zone.name;
        btn.onclick = e => { e.stopPropagation(); openZone(zone); };
        item.appendChild(btn);

        list.appendChild(item);
      });

      const lazyImages = list.querySelectorAll('img.lazy-zone-img');
      const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.classList.remove("lazy-zone-img");
            obs.unobserve(img);
          }
        });
      }, { rootMargin: "120px", threshold: 0.1 });

      lazyImages.forEach(img => observer.observe(img));
    }

    async function listZones() {
      try {
        const response = await fetch(zonesURL + "?t=" + Date.now());
        const json = await response.json();
        zones = json;
        await fetchPopularity();
        sortZones();
        updateRecentlyPlayed();

        const search = new URLSearchParams(window.location.search);
        const id = search.get('id');
        const embed = window.location.hash.includes("embed");
        if (id) {
          const zone = zones.find(zone => zone.id + '' == id + '');
          if (zone) {
            if (embed) {
              if (zone.url.startsWith("http")) {
                window.open(zone.url, "_blank");
              } else {
                const url = zone.url.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
                fetch(url + "?t=" + Date.now()).then(response => response.text()).then(html => {
                  document.documentElement.innerHTML = html;
                  const popup = document.createElement("div");
                  popup.style.position = "fixed";
                  popup.style.bottom = "20px";
                  popup.style.right = "20px";
                  popup.style.backgroundColor = "#cce5ff";
                  popup.style.color = "#004085";
                  popup.style.padding = "10px";
                  popup.style.border = "1px solid #b8daff";
                  popup.style.borderRadius = "5px";
                  popup.style.boxShadow = "0px 0px 10px rgba(0,0,0,0.1)";
                  popup.style.fontFamily = "Arial, sans-serif";
                  popup.innerHTML = `Play more games at <a href="https://gn-math.github.io" target="_blank" style="color:#004085; font-weight:bold;">https://gn-math.github.io</a>!`;
                  const closeBtn = document.createElement("button");
                  closeBtn.innerText = "✖";
                  closeBtn.style.marginLeft = "10px";
                  closeBtn.style.background = "none";
                  closeBtn.style.border = "none";
                  closeBtn.style.cursor = "pointer";
                  closeBtn.style.color = "#004085";
                  closeBtn.style.fontWeight = "bold";
                  closeBtn.onclick = () => popup.remove();
                  popup.appendChild(closeBtn);
                  document.body.appendChild(popup);
                  document.documentElement.querySelectorAll('script').forEach(oldScript => {
                    const newScript = document.createElement('script');
                    if (oldScript.src) newScript.src = oldScript.src;
                    else newScript.textContent = oldScript.textContent;
                    document.body.appendChild(newScript);
                  });
                }).catch(error => alert("Failed to load zone: " + error));
              }
            } else {
              openZone(zone);
            }
          }
        }
      } catch (error) {
        console.error(error);
        container.innerHTML = `Error loading zones: ${error}`;
      }
    }

    async function fetchPopularity() {
      try {
        const response = await fetch("https://data.jsdelivr.com/v1/stats/packages/gh/gn-math/html@main/files?period=year");
        const data = await response.json();
        data.forEach(file => {
          const idMatch = file.name.match(/\/(\d+)\.html$/);
          if (idMatch) {
            const id = parseInt(idMatch[1]);
            popularityData[id] = file.hits.total;
          }
        });
      } catch (error) {
        popularityData[0] = 0;
      }
    }

    function sortZones() {
      zones.sort((a, b) => a.name.localeCompare(b.name));
      displayZones(zones);
      updateRecentlyPlayed();
    }

    function displayZones(zonesToShow) {
      container.innerHTML = "";
      zonesToShow.forEach(file => {
        const zoneItem = document.createElement("div");
        zoneItem.className = "zone-item";
        zoneItem.onclick = () => openZone(file);
        const img = document.createElement("img");
        img.dataset.src = file.cover.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
        img.alt = file.name;
        img.loading = "lazy";
        img.className = "lazy-zone-img";
        zoneItem.appendChild(img);
        const button = document.createElement("button");
        button.textContent = file.name;
        button.onclick = (event) => { event.stopPropagation(); openZone(file); };
        zoneItem.appendChild(button);
        container.appendChild(zoneItem);
      });
      if (container.innerHTML === "") {
        container.innerHTML = "No zones found.";
      } else {
        document.getElementById("allZonesWrapper").querySelector("summary").textContent = `All Games (${zonesToShow.length})`;
      }
      const lazyImages = container.querySelectorAll('img.lazy-zone-img');
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.classList.remove("lazy-zone-img");
            observer.unobserve(img);
          }
        });
      }, { rootMargin: "100px", threshold: 0.1 });
      lazyImages.forEach(img => imageObserver.observe(img));
    }

    function filterZones() {
      const query = searchBar.value.toLowerCase();
      const filteredZones = zones.filter(zone => zone.name.toLowerCase().includes(query));
      displayZones(filteredZones);
    }

    function openZone(file) {
      recordRecent(file.id);

      if (file.url.startsWith("http")) {
        window.open(file.url, "_blank");
      } else {
        document.getElementById('zoneName').textContent = "Loading...";
        zoneFrame.style.opacity = "0.3";
        zoneFrame.style.pointerEvents = "none";
        document.getElementById("zoneLoading").style.display = "block";

        const url = file.url.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);

        fetch(url + "?t=" + Date.now())
          .then(response => response.text())
          .then(html => {
            if (zoneFrame.contentDocument === null) {
              zoneFrame = document.createElement("iframe");
              zoneFrame.id = "zoneFrame";
              zoneViewer.appendChild(zoneFrame);
            }
            zoneFrame.contentDocument.open();
            zoneFrame.contentDocument.write(html);
            zoneFrame.contentDocument.close();
            zoneFrame.style.opacity = "1";
            zoneFrame.style.pointerEvents = "auto";
            document.getElementById("zoneLoading").style.display = "none";
            document.getElementById('zoneName').textContent = file.name;
            document.getElementById('zoneId').textContent = file.id;
            document.getElementById('zoneAuthor').textContent = "by " + file.author;
            if (file.authorLink) document.getElementById('zoneAuthor').href = file.authorLink;
            zoneViewer.style.display = "block";
            const newURL = new URL(window.location);
            newURL.searchParams.set('id', file.id);
            history.pushState(null, '', newURL.toString());
          })
          .catch(error => {
            document.getElementById("zoneLoading").style.display = "none";
            alert("Failed to load zone: " + error);
          });
      }
    }

    function aboutBlank() {
      const newWindow = window.open("about:blank", "_blank");
      let zone = zones.find(z => z.id + '' === document.getElementById('zoneId').textContent);
      const url = zone.url.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
      fetch(url + "?t=" + Date.now()).then(r => r.text()).then(html => {
        if (newWindow) {
          newWindow.document.open();
          newWindow.document.write(html);
          newWindow.document.close();
        }
      });
    }

    function closeZone() {
      zoneViewer.style.display = "none";
      const url = new URL(window.location);
      url.searchParams.delete('id');
      history.pushState(null, '', url.toString());
    }

    function downloadZone() {
      let zone = zones.find(z => z.id + '' === document.getElementById('zoneId').textContent);
      fetch(zone.url.replace("{HTML_URL}", htmlURL) + "?t=" + Date.now())
        .then(res => res.text())
        .then(text => {
          const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = zone.name + ".html";
          a.click();
          URL.revokeObjectURL(url);
        });
    }

    function fullscreenZone() {
      const el = zoneFrame;
      if (el.requestFullscreen) el.requestFullscreen();
      else if (el.mozRequestFullScreen) el.mozRequestFullScreen();
      else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
      else if (el.msRequestFullscreen) el.msRequestFullscreen();
    }

    function saveData() {
      let data = JSON.stringify(localStorage) + "\n\n|\n\n" + document.cookie;
      const link = document.createElement("a");
      link.href = URL.createObjectURL(new Blob([data], { type: "text/plain" }));
      link.download = `${Date.now()}.data`;
      link.click();
    }

    function loadData(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        const [lsData, cookieData] = e.target.result.split("\n\n|\n\n");
        try {
          const parsed = JSON.parse(lsData);
          for (let key in parsed) localStorage.setItem(key, parsed[key]);
        } catch {}
        if (cookieData) {
          cookieData.split("; ").forEach(c => document.cookie = c);
        }
        alert("Data loaded");
        location.reload();
      };
      reader.readAsText(file);
    }

    function cloakIcon(url) {
      const link = document.querySelector("link[rel~='icon']") || document.createElement('link');
      link.rel = "icon";
      link.href = url.trim() || "favicon.png";
      document.head.appendChild(link);
    }

    function cloakName(string) {
      document.title = string.trim() || "Home";
    }

    function tabCloak() {
      closePopup();
      document.getElementById('popupTitle').textContent = "Tab Cloak";
      document.getElementById('popupBody').innerHTML = `
        <label for="tab-cloak-title">Set Tab Title:</label><br>
        <input type="text" id="tab-cloak-title" placeholder="Enter new tab name..." oninput="cloakName(this.value)"><br><br>
        <label for="tab-cloak-icon">Set Tab Icon URL:</label><br>
        <input type="text" id="tab-cloak-icon" placeholder="Enter icon URL..." oninput="cloakIcon(this.value)">
      `;
      document.getElementById('popupOverlay').style.display = "flex";
    }

    document.getElementById('settings').addEventListener('click', () => {
      document.getElementById('popupTitle').textContent = "Settings";
      document.getElementById('popupBody').innerHTML = `
        <button onclick="tabCloak()">Tab Cloak</button>
      `;
      document.getElementById('popupOverlay').style.display = "flex";
    });

    function showContact() {
      document.getElementById('popupTitle').textContent = "Contact";
      document.getElementById('popupBody').innerHTML = `
        <p>Discord: https://discord.gg/NAFw4ykZ7n</p>
        <p>Email: gn.math.business@gmail.com</p>
      `;
      document.getElementById('popupOverlay').style.display = "flex";
    }

    function loadPrivacy() {
      document.getElementById('popupTitle').textContent = "Privacy Policy";
      document.getElementById('popupBody').innerHTML = `
        <div style="max-height:60vh; overflow-y:auto;">
          <h2>PRIVACY POLICY</h2>
          <p>Last updated April 17, 2025</p>
          <p>This Privacy Notice describes how gn-math collects, uses, and shares personal information...</p>
        </div>
      `;
      document.getElementById('popupOverlay').style.display = "flex";
    }

    function closePopup() {
      document.getElementById('popupOverlay').style.display = "none";
    }

    listZones();

    const schoolList = ["deledao", "goguardian", "lightspeed", "linewize", "securly", ".edu/"];
    function isBlockedDomain(url) {
      const domain = new URL(url, location.origin).hostname + "/";
      return schoolList.some(s => domain.includes(s));
    }

    const originalFetch = window.fetch;
    window.fetch = function(url, options) {
      if (isBlockedDomain(url)) return Promise.reject(new Error("blocked"));
      return originalFetch.apply(this, arguments);
    };

    const originalOpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(method, url) {
      if (isBlockedDomain(url)) return;
      return originalOpen.apply(this, arguments);
    };

    HTMLCanvasElement.prototype.toDataURL = function() { return ""; };
  </script>
</body>
</html>

